<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>VIRTUAL LOT</title>

<link rel="stylesheet" href="css/leaflet.css">
<link rel="stylesheet" href="style.css">
</head>

<body>

<!-- HEADER -->
<div id="header">
    <img src="images/puo.png" alt="PUO">
    <span>üåø TAMAN PERUMAHAN</span>
</div>

<!-- TOGGLE BUTTON -->
<button id="toggleBtn" onclick="toggleSidebar()">‚ò∞ Menu</button>

<!-- SIDEBAR -->
<div id="sidebar">
    <button class="closeBtn" onclick="toggleSidebar()">‚úñ Tutup</button>

    <h3>üåç Land Explorer</h3>

    <input type="text" id="searchLot" placeholder="Lot Number">
    <button onclick="searchLot()">Search</button>
    <button onclick="resetMap()">Reset Map</button>

    <hr>

    <div class="info">
        <p><b>Total Lots</b><br>
        <span id="totalLots">0</span></p>

        <p><b>Selected Area</b><br>
        <span id="selectedArea">-</span></p>
    </div>
</div>

<!-- MAP -->
<div id="map"></div>

<script src="js/leaflet.js"></script>
<script src="data/LOTFINAL_0.js"></script>

<script>
function toggleSidebar(){
    document.getElementById("sidebar").classList.toggle("active");
}

/* MAP */
var map = L.map('map').fitBounds([
    [2.102821,102.520895],
    [2.104582,102.524810]
]);

L.tileLayer(
'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'
).addTo(map);

function styleLot(){
    return {
        color:"#1b5e20",
        weight:1,
        fillColor:"#66bb6a",
        fillOpacity:0.7
    };
}

var lotLayer = L.geoJSON(json_LOTFINAL_0,{
    style:styleLot,
    onEachFeature:function(feature,layer){
        document.getElementById("totalLots").innerText =
        json_LOTFINAL_0.features.length;

        layer.on("click",function(){
            document.getElementById("selectedArea").innerText =
            feature.properties.AREA;
        });
    }
}).addTo(map);

function searchLot(){
    var input = document.getElementById("searchLot").value.toLowerCase();
    lotLayer.eachLayer(function(layer){
        if(layer.feature.properties.NO_LOT.toLowerCase().includes(input)){
            map.fitBounds(layer.getBounds());
            layer.setStyle({fillColor:"#ffeb3b"});
        }
    });
}

function resetMap(){
    document.getElementById("searchLot").value="";
    document.getElementById("selectedArea").innerText="-";
    lotLayer.eachLayer(function(layer){
        layer.setStyle(styleLot());
    });
}
</script>

</body>
</html>
