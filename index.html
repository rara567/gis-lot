<script>
function toggleSidebar(){
    document.getElementById("sidebar").classList.toggle("active");
}

/* MAP */
var map = L.map('map').fitBounds([
    [2.102821,102.520895],
    [2.104582,102.524810]
]);

/* GOOGLE MAPS */
var googleStreet = L.tileLayer(
'https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
    maxZoom:20,
    subdomains:['mt0','mt1','mt2','mt3']
});

var googleSatellite = L.tileLayer(
'https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
    maxZoom:20,
    subdomains:['mt0','mt1','mt2','mt3']
}).addTo(map);

/* ðŸ”¥ BUAT PANE KHAS UNTUK LOT */
map.createPane('lotPane');
map.getPane('lotPane').style.zIndex = 650;

/* STYLE LOT */
function styleLot(){
    return {
        pane: 'lotPane',
        color:"#1b5e20",
        weight:1,
        fillColor:"#66bb6a",
        fillOpacity:0.7
    };
}

/* LOT LAYER */
var lotLayer = L.geoJSON(json_LOTFINAL_0,{
    style:styleLot,
    onEachFeature:function(feature,layer){

        document.getElementById("totalLots").innerText =
        json_LOTFINAL_0.features.length;

        layer.on("click",function(){
            document.getElementById("selectedArea").innerText =
            feature.properties.AREA + " mÂ²";

            layer.bringToFront(); // ðŸ”¥ PENTING

            layer.bindPopup(
                "<b>No Lot:</b> " + feature.properties.NO_LOT +
                "<br><b>Luas:</b> " + feature.properties.AREA + " mÂ²"
            ).openPopup();
        });
    }
}).addTo(map);

/* SEARCH */
function searchLot(){
    var input = document.getElementById("searchLot").value.toLowerCase();

    lotLayer.eachLayer(function(layer){
        layer.setStyle(styleLot());

        if(layer.feature.properties.NO_LOT.toLowerCase() === input){
            map.fitBounds(layer.getBounds());
            layer.setStyle({
                fillColor:"#ffeb3b",
                color:"#f57f17"
            });
            layer.bringToFront(); // ðŸ”¥
        }
    });
}

/* RESET */
function resetMap(){
    document.getElementById("searchLot").value="";
    document.getElementById("selectedArea").innerText="-";

    lotLayer.eachLayer(function(layer){
        layer.setStyle(styleLot());
    });

    map.fitBounds(lotLayer.getBounds());
}

/* LAYER CONTROL */
L.control.layers(
    {
        "Google Street": googleStreet,
        "Google Satellite": googleSatellite
    },
    {
        "Lot Tanah": lotLayer
    }
).addTo(map);

</script>
